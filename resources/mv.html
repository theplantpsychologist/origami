<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MV Assignment</title>
    <link rel="stylesheet" type = "text/css" href="../style.css">
</head>
<body>
    <div id='wrapper'>
        <div id='head'>
            <a id = "name" href="../index.html"><img src="../img/logo.svg" style="width: 50%;" alt="logo"></a>
            <hr>
            <div id='navigator'>
                <a class="navlink" href="../index.html">Home</a>
                <a class="navlink" href="../about.html">Origami</a>
                <a class="navlink" href="../resources.html">Resources</a>
                <a class="navlink" href="../other.html">Other</a>
            </div>
        </div>
        <hr>
        <h1>Automated Mountain-Valley Assignment</h1>
        <div>
            <noscript>Please enable javascript to use this app.</noscript>
            <p id="import">Upload a .cp file below. Use auxilary lines to indicate creases of unknown MV.</p>
            <div>
                <input type="file" id="inputfile" name="inputfile" />
                <pre id="output"></pre>
                <script>
                    function UploadCp() {
                        const reader = new FileReader();
                        reader.onload = function () {
                            input = reader.result.split("\n");
                            start(input);
                        };
                        const fileSelector = document.getElementById("inputfile");
                        if (fileSelector) {
                            reader.readAsText(fileSelector.files[0]);
                        } else {
                            console.log("File input element not present");
                        }
                    }
                </script>
                <button id="upload" type=button onclick="UploadCp()">Upload</button>
            </div>
        </div>

        <div>
            <button type = button onclick="dfs(inputcp)">Find one solution</button>
            <button type = button onclick="download()">Save as .cp file</button>
        </div> 
        <br>

        <canvas id="square" width="800" height = "900"></canvas>
        <script src="paper-core.js"></script>
        <script src="origami.js"></script>
        <script type="text/javascript" data-paper-ignore="true">
            paper.setup(document.getElementById("square"))
            var inputcp = null;
            function start(input){
                paper.project.clear();
                console.log("starting");
                inputcp = readCpFile(input);
                inputcp.displayCp(10,50,390,430)

                //inputcp.findFaces();
                //inputcp.displayXray(10,450,390,830);
            }

            function dfs(inputcp){
                //check for angular flat foldability
                //check for global self intersection
                if(!inputcp.angularFoldable){
                    alert("This crease pattern has local flat foldability issues. Please fix the highlighted vertices and try again.")
                    return
                }
                inputcp.findFaces();
                inputcp.foldXray();
                inputcp.displayXray(10,450,390,830);

                //dfs will run a dfs of a binary tree made of PotentialCP until one solution is found
                //it's also running a bfs on a connectivity matrix of the faces. for n faces, we'll store it as an nxn matrix
                //a 0 in spot (i,j) means faces i and j are not connected
                //a
            }

            class PotentialCP extends CP{
                //this is the node of a binary tree. the input cp will be the root node.

                //has a parent and up to 2 children: one m and one v.
                //also has an attribute if it's "alive" or not
                //if it has been checked to be alive, create a mountain child. (unless the cp is done)
                //if it has been checked to not be alive, no more children, and tell the parent

                //if it's mountain child is dead, create a valley child.
                //If the valley child also dies, be marked as dead and go up to parent.
            }


        </script>


    
    </div>
</body>
</html>